FOPEN MACRO FILEHANDLE,FILENAME,modl,FILEERROR
    push AX
    push CX
    push DX
    MOV AH,3CH
    mov AL,modl
    MOV CX,00
    LEA DX,FILENAME
    INT 21H
    MOV FILEHANDLE,AX
    pop DX
    pop CX
    pop AX
    JC FILEERROR
ENDM

FILEWRITESTR MACRO FILEHANDLE,STR,LEN,FILEERROR
    MOV CX,LEN
    MOV AH,40H
    MOV BX,FILEHANDLE
    LEA DX,STR 
    INT 21H
    JC FILEERROR
    CMP AX,CX
    JNE FILEERROR
ENDM

FWRITEMEM MACRO FILEHANDLE,STR,LEN,FILEERROR
    MOV CX,LEN
    MOV AH,40H
    MOV BX,FILEHANDLE
    MOV DX,STR 
    INT 21H
    JC FILEERROR
    CMP AX,CX
    JNE FILEERROR
ENDM
FWRITERBUF MACRO FILEHANDLE,BUFF,FILEERROR
    LEA BX,BUFF
    MOV SI,1
    MOV Cl,[BX+SI]
    mov ch,0
    MOV AH,40H
    MOV BX,FILEHANDLE
    LEA DX,BUFF
    INC DX
    INC DX
    INT 21H

    JC FILEERROR
    CMP AX,CX
    JNE FILEERROR
ENDM

FCLOSE MACRO FILEHANDLE
    MOV AH,3EH
    MOV BX,FILEHANDLE
    INT 21H
ENDM

FREADTOBUF MACRO FILEHANDLE,BUFF,READSIZE,FILEERROR
    MOV AH,3FH
    MOV BX,FILEHANDLE
    MOV CX,READSIZE
    LEA DX,BUFF
    INC DX
    INC DX
    INT 21H
    JC FILEERROR
    LEA BX,BUFF
    INC BX
    MOV [BX],AL
ENDM